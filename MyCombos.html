<!DOCTYPE html>
<html lang="en">
<head>
  <title>Combinations</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <link rel="stylesheet" href="animate.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  <style>
  
  /* W3.CSS 4.04 Apr 2017 by Jan Egil and Borge Refsnes */
html{box-sizing:border-box}*,*:before,*:after{box-sizing:inherit}
/* Extract from normalize.css by Nicolas Gallagher and Jonathan Neal git.io/normalize */
html{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}
img{border-style:none}

::-webkit-input-placeholder{color:inherit;opacity:0.54}
::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}
/* End extract */

html,body{font-family:Verdana,sans-serif;font-size:15px;line-height:1.5}html{overflow-x:hidden}
h3{font-family:"Segoe UI",Arial,sans-serif;font-weight:10;margin:10px 0;color:#3b7aaf;
    text-align:left;
    font-size:3vw;
    display: block;}

.my-image{max-width:100%;height:auto}img{margin-bottom:-5px}

.my-display-container{position:relative}
.my-container:after,.my-container:before,.my-row-padding:after,.my-row-padding:before{content:"";display:table;clear:both}
.my-col{float:left;width:100%}

@media (min-width:601px){.my-col.m6{width:49.99999%}}
@media (min-width:993px){.my-col.l3{width:24.99999%}}
.my-content{max-width:980px;margin:auto}

.my-display-topleft{position:absolute;left:0;top:0}

.my-row-padding,.my-row-padding>.my-col{padding:0 8px}
.my-container{padding:0.01em 16px}

.my-border-bottom{border-bottom-color: #d3d3d3; border-style: solid; border-bottom-width: thin; border-top-color: transparent; border-right-color: transparent; border-left-color: transparent;}
.my-margin-bottom{margin-bottom:16px!important}
.my-padding{padding:8px 16px!important}
.my-padding-16{padding-top:16px!important;padding-bottom:16px!important}
.my-padding-0-16{padding-top:0px!important;padding-bottom:16px!important}
.my-padding-32{padding-top:32px!important;padding-bottom:32px!important}
.my-padding-0-32{padding-top:0px!important;padding-bottom:32px!important}

.my-black{color:#fff!important;background-color:#000!important}

 .logo{
 background-image:url("smart_house_logo.png");
 background-size: 56px 56px;
 background-repeat: no-repeat;
 width: 56px;
 height: 56px;
}

 .justify-center-56px{
  justify-content: center;
  display: flex;
  flex-direction: row;
  height: 56px;
 }

 .flex-center{
  display: flex;
  align-items: center;
 }

 .tam{
    font-size:16px;
 }

 .color{
  background-color: black;
 }
}

 .modal-footer{
  background-color: #D8E4EF;
  border-bottom-right-radius: 12px;
  border-bottom-left-radius: 12px;
 }

.modal-header{
  border-bottom-right-radius: 12px;
  border-bottom-left-radius: 12px;
 }

 </style>
</head>
<body onload="loadRoutines()">

<nav class="navbar navbar-inverse color">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>                        
      </button>
      <a class="navbar-brand logo" href="Home.html"></a>
    </div>
    <div class="collapse navbar-collapse" id="myNavbar">
      <ul class="nav navbar-nav justify-center-56px">
        <li><a class="flex-center tam" href="MyDevices.html">Rooms and Devices</a></li>
        <li><a class="flex-center tam" href="MyCombos.html">Combinations</a></li>
        <li><a class="flex-center tam" href="MyAgenda.html">Agenda</a></li>
        <li><a class="flex-center tam" href="Now On.html">Now On</a></li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
          <a class="dropdown-toggle flex-center tam" data-toggle="dropdown" href="#">My Profile <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="#">Configurations</a></li>
            <li><a href="#">News</a></li>
            <li><a href="Profiles.html">Change Profile</a></li>
            <li><a href="Main Page.html">Log out</a></li>
          </ul>
        </li>
      </ul>
    </div>
  </div>
</nav>
  
<!-- Page content -->
<div class="my-content my-padding" id="routinesContainer" style="max-width:1564px">

  <!-- Project Section -->
  <div class="my-container my-padding-0-32">
    <h3 class="my-border-bottom my-padding-0-16">Combinations</h3>
  </div>
  <div class="my-row-padding" id="firstRow">
    <div class="my-col l3 m6 my-margin-bottom">
      <div class="my-display-container">
        <div class="my-display-topleft my-black my-padding">Add Combination</div>
          <button class="btn btn-default" onclick="createCombination()">
            <img src="Add Combo.png" alt="Agregar Combinacion" class="my-image">
          </button>
      </div>
    </div>
  </div>
 
<!-- End page content -->
</div>

<script>

  var api = class {
  static get baseUrl() {
    return "http://127.0.0.1:8080/api/";
  }

  static get timeout() {
    return 60 * 1000;
  }
}

api.model = api.model || {};

api.model.routine = class {
  constructor(id, name, actions, meta) {
    if (id) {
      this.id = id;
    } else {
      delete(this.id);
    }
    this.name = name;
    this.actions = actions;
    this.meta = meta;
  }
}

api.routine = class{
  static get url() {
    return api.baseUrl + "routines/";
  }

  static add(routine) {
   return $.ajax({
      url: api.routines.url,
      method: "POST",
      dataType: "json",
      timeout: api.timeout,
      data: routine
    }); 
  }

  static modify(routine) {
   return $.ajax({
      url: api.routine.url + routine.id,
      method: "PUT",
      dataType: "json",
      timeout: api.timeout,
      data: routine
    }); 
  }

  static delete(id) {
   return $.ajax({
      url: api.routine.url + id,
      method: "DELETE",
      dataType: "json",
      timeout: api.timeout,
    }); 
  }

  static get(id) {
    return $.ajax({
      url: api.routine.url + id,
      method: "GET",
      dataType: "json",
      timeout: api.timeout
    });
  }

  static getAll(){
    return $.ajax({
      url: api.routine.url,
      method: "GET",
      dataType: "json",
      timeout: api.timeout
    });
  }

  static execute(id){
    return $.ajax({
      url: api.routine.url + routine.id + "/execute",
      method: "PUT",
      dataType: "json",
      timeout: api.timeout
    });
  }
}

function loadRoutines(){

  api.routine.getAll()

  .done(function (data) {
    loadRoutinesHTML(data);
  })

  .fail(function (jqXHR, textStatus) {
    alert ('Request failed:' + textStatus);
  })
}   

function loadRoutinesHTML(data){
  var i, father, currentRow;

  currentRow = document.getElementById("firstRow");
  father = document.getElementById("routinesContainer");

  for(i = 0; i < data.routines.length; i++){
    if((i % 4) == 0){
      if(i >= 3){
        currentRow = createRow();
        father.appendChild(currentRow);
      }
    }

    currentRow.appendChild(loadRoutine(data, i));
  }
}

function createRow(){
  var row = document.createElement("div");
  row.classList.add("my-row-padding");

  return row;
}

function loadRoutine(data, i){
  var routineContainer = document.createElement("div");
  routineContainer.classList.add("my-col");
  routineContainer.classList.add("l3");
  routineContainer.classList.add("m6");
  routineContainer.classList.add("my-margin-bottom");

  var displayContainer = document.createElement("div");
  displayContainer.classList.add("my-display-container");

  routineContainer.appendChild(displayContainer);

  var tag = document.createElement("div");
  tag.classList.add("my-display-topleft");
  tag.classList.add("my-black");
  tag.classList.add("my-padding");

  displayContainer.appendChild(tag);

  var routineName = data.routines[i].name;
  tag.innerHTML = routineName;

  var routineButton = document.createElement("button");
  routineButton.classList.add("btn");
  routineButton.classList.add("btn-default");
  routineButton.setAttribute("id", data.routines[i].id);

  displayContainer.appendChild(routineButton);

  var routineImage = document.createElement("img");
  routineImage.setAttribute("alt", routineName);
  routineImage.classList.add("my-image");
  routineImage.setAttribute("src", "Combo.png");

  routineButton.appendChild(routineImage);

  return routineContainer;
}

function createCombination(){
  
}

</script>

</body>
</html>
