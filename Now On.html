<!DOCTYPE html>
<html lang="en">
<head>
  <title>Switched On</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <link rel="stylesheet" href="animate.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

  <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-colorpicker/2.3.6/css/bootstrap-colorpicker.css" rel="stylesheet">
  <script src="https://code.jquery.com/jquery-2.2.2.min.js"></script>
  <link href="https://gitcdn.github.io/bootstrap-toggle/2.2.2/css/bootstrap-toggle.min.css" rel="stylesheet">
  <script src="https://gitcdn.github.io/bootstrap-toggle/2.2.2/js/bootstrap-toggle.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-colorpicker/2.3.6/js/bootstrap-colorpicker.js"></script>

  <style>

html{box-sizing:border-box}*,*:before,*:after{box-sizing:inherit}
/* Extract from normalize.css by Nicolas Gallagher and Jonathan Neal git.io/normalize */
html{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}
img{border-style:none}

::-webkit-input-placeholder{color:inherit;opacity:0.54}
::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}
/* End extract */

html,body{font-family:Verdana,sans-serif;font-size:15px;line-height:1.5}html{overflow-x:hidden}
h3{font-family:"Segoe UI",Arial,sans-serif;font-weight:10;margin:10px 0;color:#3b7aaf;
    text-align:left;
    font-size:3vw;
    display: block;}

.my-image{max-width:100%;height:auto}img{margin-bottom:-5px}

.my-display-container{position:relative}
.my-container:after,.my-container:before,.my-row-padding:after,.my-row-padding:before{content:"";display:table;clear:both}
.my-col{float:left;width:100%}

@media (min-width:700px){.my-col.m6{width:49.99999%}}
@media (min-width:1300px){.my-col.l3{width:24.99999%}}
.my-content{max-width:980px;margin:auto}

.my-display-topleft{position:absolute;left:0;top:0}

.my-row-padding,.my-row-padding>.my-col{padding:0 8px}
.my-container{padding:0.01em 16px}

.my-border-bottom{border-bottom-color: #d3d3d3; border-style: solid; border-bottom-width: thin; border-top-color: transparent; border-right-color: transparent; border-left-color: transparent;}
.my-margin-bottom{margin-bottom:16px!important}
.my-padding{padding:8px 16px!important}
.my-padding-16{padding-top:16px!important;padding-bottom:16px!important}
.my-padding-0-16{padding-top:0px!important;padding-bottom:16px!important}
.my-padding-32{padding-top:32px!important;padding-bottom:32px!important}
.my-padding-0-32{padding-top:0px!important;padding-bottom:32px!important}

.my-black{color:#fff!important;background-color:#000!important}

 .logo{
 background-image:url("smart_house_logo.png");
 background-size: 56px 56px;
 background-repeat: no-repeat;
 width: 56px;
 height: 56px;
}

 .justify-center-56px{
  justify-content: center;
  display: flex;
  flex-direction: row;
  height: 56px;
 }

 .flex-center{
  display: flex;
  align-items: center;
 }

 .tam{
    font-size:16px;
 }

 .color{
  background-color: black;
 }

.modal-footer{
  background-color: #D8E4EF;
  border-bottom-right-radius: 12px;
  border-bottom-left-radius: 12px;
 }

.modal-header{
  border-bottom-right-radius: 12px;
  border-bottom-left-radius: 12px;
 }

.modal-text-device{
  font-size:200%;
}

.trampa{
  color:white;
}

.error{
  color:red;
  font-size:75%;
  display:none;
}

 </style>
</head>
<body onload="loadDevices()">

<nav class="navbar navbar-inverse color">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>                        
      </button>
      <a class="navbar-brand logo" href="Home.html"></a>
    </div>
    <div class="collapse navbar-collapse" id="myNavbar">
      <ul class="nav navbar-nav justify-center-56px">
        <li><a class="flex-center tam" href="MyDevices.html">Rooms and Devices</a></li>
        <li><a class="flex-center tam" href="MyCombos.html">Combinations</a></li>
        <li><a class="flex-center tam" href="MyAgenda.html">Agenda</a></li>
        <li><a class="flex-center tam" href="Now On.html">Switched On</a></li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
          <a class="dropdown-toggle flex-center tam" data-toggle="dropdown" href="#">My Profile <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="#">Configurations</a></li>
            <li><a href="#">News</a></li>
            <li><a href="Profiles.html">Change Profile</a></li>
            <li><a href="Main Page.html">Log out</a></li>
          </ul>
        </li>
      </ul>
    </div>
  </div>
</nav>

   <!-- Confirmation modal delete device-->
  <div class="modal fade" id="confirmation-Delete-device" role="dialog">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h3 class="modal-title text-center" id="delete-modal-device-name"><h3>
        </div>
        <div class="modal-body">
          <p class="confirm-delete-text">Are you sure you want to delete this device?</p>
        </div>
        <div class="modal-footer">
          <button type="submit" class="btn btn-primary" id="accept-delete-device">Accept </button>
          <button type="submit" class="btn btn-default" data-dismiss="modal">Cancel</button>
        </div>  
      </div>
    </div>
  </div> 


  <!-- MODALS DE DEVICES-->

  <!-- MODAL DE BLIND-->
  <div class="modal fade" id="device-blinds" role="dialog">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
            <h3 class="modal-title text-center">Blinds</h3>
        </div>
        <div class="modal-body">
          <form class="form-horizontal">
            <div class="form-group">
              <label for="blinds-type" class="control-label col-sm-4" style="text-align: right">Type:</label>
              <div class="col-sm-8">
                <p class="form-control-static" id="blinds-type" style="text-align: left">Blinds</p>
              </div>
              <br>
              <label for="blinds-name" class="control-label col-sm-4" style="text-align: right;">Name:</label>
              <div class="col-sm-8">
                <p class="form-control-static" id="blinds-name" style="text-align: left"></p> <!--hay que agregar el nombre que eligio el usuario-->
              </div>
              <label for="blinds-change-name" class="control-label col-sm-4" style="text-align: right">Change name:</label>
              <div class="col-sm-8">
                <input type="text" class="form-control" id="blinds-change-name" placeholder="Enter new name" name="blinds-change-name">
                <p class="error" id="error-name-blind">The name must have between 3 and 30 characters </p>
                <p class="error" id="error-nameExist-blind">This name already exists</p>
              </div>
              <br>
              <label for="blinds-description" class="control-label col-sm-4" style="text-align: right">Description:</label>
              <div class="col-sm-8">
                <p class="form-control-static" id="blinds-description" style="text-align: left"> </p> <!--hay que agregar la descripcion que puso el usuario si es que la hubo, y "none" si es que no puso nada-->
              </div>
              <label for="blinds-change-description" class="control-label col-sm-4" style="text-align: right">Change description:</label>
              <div class="col-sm-8">
                <input type="text" class="form-control" placeholder="Enter new description" name="blinds-change-description" id="blinds-change-description">
              </div>
              <br>
              <label for="blinds-status" class="control-label col-sm-4" style="text-align: right">Status:</label>
              <div class="col-sm-8">
                <!--agregado por cata (comentado)-->
                <!--<label class="radio-inline"><input type="radio" name="optradio" id="blinds-open">Open</label>
                <label class="radio-inline"><input type="radio" name="optradio" id="blinds-closed" checked>Closed</label>--><!--agregado por cata (comentado)-->
                <input type="checkbox" data-toggle="toggle" data-on="Open" data-off="Closed"  id="blinds-switch" data-width="82"><!--agregado por cata -->
              </div>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="submit" class="btn btn-primary" onclick="saveChangesBlinds()">Accept </button>
          <button type="submit" class="btn btn-default" data-dismiss="modal">Cancel</button>
          <button type="submit" class="btn btn-default pull-left" onclick="deleteBlinds()"><span class="glyphicon glyphicon-trash"></span> Delete</button>
        </div>
      </div>  
    </div>
  </div>

    <!-- Modal de lamp -->
  <div class="modal fade" id="device-lamp" role="dialog">
    <div class="modal-dialog">
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <h3 class="modal-title text-center">Lamp</h3>
        </div>
        <div class="modal-body">
          <form class="form-horizontal">
            <div class="form-group">
              <label for="lamp-type" class="control-label col-sm-4" style="text-align: right">Type:</label>
              <div class="col-sm-8">
                <p class="form-control-static" id="lamp-type" style="text-align: left">Lamp</p>
              </div>
              <br>
              <label for="lamp-name" class="control-label col-sm-4" style="text-align: right">Name:</label>
              <div class="col-sm-8">
                <p class="form-control-static" id="lamp-name" style="text-align: left"></p> <!--hay que agregar el nombre que eligio el usuario-->
              </div>
              <label for="lamp-change-name" class="control-label col-sm-4" style="text-align: right">Change name:</label>
              <div class="col-sm-8">
                <input type="text" class="form-control" id="lamp-change-name" placeholder="Enter new name" name="lamp-change-name">
                <p class="error" id="error-name-lamp">The name must have between 3 and 30 characters </p>
                <p class="error" id="error-nameExist-lamp">This name already exists</p>
              </div>
              <br>
              <label for="lamp-description" class="control-label col-sm-4" style="text-align: right">Description:</label>
              <div class="col-sm-8">
                <p class="form-control-static" id="lamp-description" style="text-align: left"></p> <!--hay que agregar la descripcion que puso el usuario si es que la hubo, y "none" si es que no puso nada-->
              </div>
              <label for="lamp-change-description" class="control-label col-sm-4" style="text-align: right">Change description:</label>
              <div class="col-sm-8">
                <input type="text" class="form-control" id="lamp-change-description" placeholder="Enter new description" name="lamp-change-description">
              </div>
              <p class="trampa">a</p>
              <label for="lamp-status" class="control-label col-sm-4" style="text-align: right">Status:</label>
              <div class="col-sm-8">
                <!--agregado por cata (comentado)-->
                <!--<label class="switch">
                  <input type="checkbox" id="lamp-switch">
                  <span class="slider round"></span>
                </label>--><!--agregado por cata (comentado)-->
                <input type="checkbox" data-toggle="toggle" id="lamp-switch"><!--agregado por cata -->
              </div>      
              <br>
              <label for="lamp-change-brightness" class="control-label col-sm-4" style="text-align: right">Change brightness:</label>
              <div class="col-sm-8">
                <input type="number" class="form-control" id="lamp-change-brightness" placeholder="Enter new brightness (0 - 100)" name="lamp-change-brightness" min="0" max="100"> <!--hay que verificar que sea un numero entre 0 y 100-->
                <p class="error" id="error-lamp-brightness">The brightness must be between 0 and 100</p>
              </div>
              <p class="trampa">a</p>
              <label for="lamp-change-color" class="control-label col-sm-4" style="text-align: right">Select new color:</label>
              <div class="col-sm-8">
                <div id="cp3" class="input-group colorpicker-component">
                  <input type="text" value="#00AABB" class="form-control" id="lamp-change-color">
                  <span class="input-group-addon"><i></i></span>
                </div>
                <p class="error" id="error-lamp-color">The color must be between #000000 and #FFFFFF</p>
              </div>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-primary" onclick="saveChangesLamp()">Accept</button>
          <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
          <button type="submit" class="btn btn-default pull-left" onclick="deleteLamp()"><span class="glyphicon glyphicon-trash"></span> Delete</button>
        </div>
      </div>
    </div>
  </div>


      <!-- Modal de oven -->
  <div class="modal fade" id="device-oven" role="dialog">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
            <h3 class="modal-title text-center">Oven</h3>
        </div>
        <div class="modal-body">
          <form class="form-horizontal">
            <div class="form-group">
              <label for="oven-type" class="control-label col-sm-6" style="text-align: right">Type:</label>
              <div class="col-sm-6">
                <p class="form-control-static" id="oven-type" style="text-align: left">Oven</p>
              </div>
              <br>
              <label for="oven-name" class="control-label col-sm-6" style="text-align: right;">Name:</label>
              <div class="col-sm-6">
                <p class="form-control-static" id="oven-name" style="text-align: left"></p> <!--hay que agregar el nombre que eligio el usuario-->
              </div>
              <label for="oven-change-name" class="control-label col-sm-6" style="text-align: right">Change name:</label>
              <div class="col-sm-6">
                <input type="text" class="form-control" id="oven-change-name" placeholder="Enter new name" name="oven-change-name">
                <p class="error" id="error-name-oven">The name must have between 3 and 30 characters </p>
                <p class="error" id="error-nameExist-oven">This name already exists</p>
              </div>
              <br>
              <label for="oven-description" class="control-label col-sm-6" style="text-align: right">Description:</label>
              <div class="col-sm-6">
                <p class="form-control-static" id="oven-description" style="text-align: left"></p> <!--hay que agregar la descripcion que puso el usuario si es que la hubo, y "none" si es que no puso nada-->
              </div>
              <label for="oven-change-description" class="control-label col-sm-6" style="text-align: right">Change description:</label>
              <div class="col-sm-6">
                <input type="text" class="form-control" id="oven-change-description" placeholder="Enter new description" name="oven-change-description">
              </div>
              <br>
              <p class="trampa">a</p>
              <label for="oven-status" class="control-label col-sm-6" style="text-align: right">Status:</label>
              <div class="col-sm-6">
                <!--agregado por cata (comentado)-->
                <!--<label class="switch">
                  <input type="checkbox" id="oven-switch">
                  <span class="slider round"></span>
                </label>--><!--agregado por cata (comentado)-->
                <input type="checkbox" data-toggle="toggle" id="oven-switch"><!--agregado por cata -->
              </div> 
              <br>
              <label for="oven-change-temperature" class="control-label col-sm-6" style="text-align: right;">Change temperature:</label>
              <div class="col-sm-6">
                <input type="number" class="form-control" id="oven-change-temperature" placeholder="Enter new temperature (90 - 230)" name="oven-change-temperature" min="90" max="230">    <!--hay que verificar que este entre 90 y 230-->
                <p class="error" id="error-oven-temperature">The temperature must be between 90 and 230</p>
              </div>
              <br>
              <p class="trampa">a</p>
              <label for="oven-change-heatmode" class="control-label col-sm-6" style="text-align: right;">Change heat mode:</label>
              <div class="col-sm-6">
                <select class="form-control" id="oven-change-heatmode">
                    <option val="conventional">Conventional</option>
                    <option val="bottom">Bottom</option>
                    <option val="top">Top</option>
                  </select>
                  <p class="error" id="error-oven-heatmode">You must select an option</p>
              </div>
              <br>
              <p class="trampa">a</p>
              <label for="oven-change-grillmode" class="control-label col-sm-6" style="text-align: right;">Change grill mode:</label>
              <div class="col-sm-6">
                <select class="form-control" id="oven-change-grillmode">
                    <option val="large">Large</option>
                    <option val="eco">Eco</option>
                    <option val="off">Off</option>
                  </select>
                  <p class="error" id="error-oven-grillmode">You must select an option</p>
              </div>
              <br>
              <p class="trampa">a</p>
              <label for="oven-change-convectionmode" class="control-label col-sm-6" style="text-align: right;">Change convection mode:</label>
              <div class="col-sm-6">
                <select class="form-control" id="oven-change-convectionmode">
                    <option val="normal">Normal</option>
                    <option val="eco">Eco</option>
                    <option val="off">Off</option>
                  </select>
                  <p class="error" id="error-oven-convectionmode">You must select an option</p>
              </div>
            </div> 
          </form>
        </div>
        <div class="modal-footer">
          <button type="submit" class="btn btn-primary" onclick="saveChangesOven()">Accept </button>
          <button type="submit" class="btn btn-default" data-dismiss="modal">Cancel</button>
          <button type="submit" class="btn btn-default pull-left" onclick="deleteOven()"><span class="glyphicon glyphicon-trash"></span> Delete</button>
        </div>
      </div>  
    </div>
  </div>

  <!-- Modal de ac -->
  <div class="modal fade" id="device-ac" role="dialog">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
            <h3 class="modal-title text-center">Ac</h3>
        </div>
        <div class="modal-body">
          <form class="form-horizontal">
            <div class="form-group">
              <label for="ac-type" class="control-label col-sm-6" style="text-align: right">Type:</label>
              <div class="col-sm-6">
                <p class="form-control-static" id="ac-type" style="text-align: left">Ac</p>
              </div>
              <br>
              <label for="ac-name" class="control-label col-sm-6" style="text-align: right;">Name:</label>
              <div class="col-sm-6">
                <p class="form-control-static" id="ac-name" style="text-align: left"></p> <!--hay que agregar el nombre que eligio el usuario-->
              </div>
              <label for="ac-change-name" class="control-label col-sm-6" style="text-align: right">Change name:</label>
              <div class="col-sm-6">
                <input type="text" class="form-control" id="ac-change-name" placeholder="Enter new name" name="ac-change-name">
                <p class="error" id="error-name-ac">The name must have between 3 and 30 characters </p>
                <p class="error" id="error-nameExist-ac">This name already exists</p>
              </div>
              <br>
              <label for="ac-description" class="control-label col-sm-6" style="text-align: right">Description:</label>
              <div class="col-sm-6">
                <p class="form-control-static" id="ac-description" style="text-align: left"></p> <!--hay que agregar la descripcion que puso el usuario si es que la hubo, y "none" si es que no puso nada-->
              </div>
              <label for="ac-change-description" class="control-label col-sm-6" style="text-align: right">Change description:</label>
              <div class="col-sm-6">
                <input type="text" class="form-control" id="ac-change-description" placeholder="Enter new description" name="ac-change-description">
              </div>
              <br>
              <p class="trampa">a</p>
              <label for="ac-status" class="control-label col-sm-6" style="text-align: right">Status:</label>
              <div class="col-sm-6">
                <!--agregado por cata (comentado)-->
                <!--<label class="switch">
                  <input type="checkbox" id="ac-switch">
                  <span class="slider round"></span>
                </label>--><!--agregado por cata (comentado)-->
                <input type="checkbox" data-toggle="toggle" id="ac-switch"><!--agregado por cata -->
              </div> 
              <br>
              <label for="ac-change-temperature" class="control-label col-sm-6" style="text-align: right;">Change temperature:</label>
              <div class="col-sm-6">
                <input type="number" class="form-control" id="ac-change-temperature" placeholder="Enter new temperature (18 - 38)" name="ac-change-temperature" min="18" max="38">    <!--hay que verificar que este entre 18 y 38-->
                <p class="error" id="error-ac-temperature">The temperature must be between 18 and 38</p>
              </div>
              <br>
              <p class="trampa">a</p>
              <label for="ac-change-mode" class="control-label col-sm-6" style="text-align: right;">Change mode:</label>
              <div class="col-sm-6">
                <select class="form-control" id="ac-change-mode">
                    <option val="cool">Cool</option>
                    <option val="heat">Heat</option>
                    <option val="fan">Fan</option>
                  </select>
                  <p class="error" id="error-ac-mode">You must select an option</p>
              </div>
              <br>
              <p class="trampa">a</p>
              <label for="ac-change-verticalswing" class="control-label col-sm-6" style="text-align: right;">Change vertical swing:</label>
              <div class="col-sm-6">
                <select class="form-control" id="ac-change-verticalswing">
                    <option val="auto">Auto</option>
                    <option val="22">22°</option>
                    <option val="45">45°</option>
                    <option val="67">67°</option>
                    <option val="90">90°</option>
                  </select>
                  <p class="error" id="error-ac-verticalswing">You must select an option</p>
              </div>
              <br>
              <p class="trampa">a</p>
              <label for="ac-change-horizontalswing" class="control-label col-sm-6" style="text-align: right;">Change horizontal swing:</label>
              <div class="col-sm-6">
                <select class="form-control" id="ac-change-horizontalswing">
                    <option val="auto">Auto</option>
                    <option val="-90">-90°</option>
                    <option val="-45">-45°</option>
                    <option val="0">0°</option>
                    <option val="45">45°</option>
                    <option val="90">90°</option>
                  </select>
                  <p class="error" id="error-ac-horizontalswing">You must select an option</p>
              </div>
              <br>
              <p class="trampa">a</p>
              <label for="ac-change-fanspeed" class="control-label col-sm-6" style="text-align: right;">Change fan speed:</label>
              <div class="col-sm-6">
                <select class="form-control" id="ac-change-fanspeed">
                    <option val="auto">Auto</option>
                    <option val="25">25</option>
                    <option val="50">50</option>
                    <option val="75">75</option>
                    <option val="100">100</option>
                  </select>
                  <p class="error" id="error-ac-fanspeed">You must select an option</p>
              </div>
            </div> 
          </form>
        </div>
        <div class="modal-footer">
          <button type="submit" class="btn btn-primary" onclick="saveChangesAc()">Accept </button>
          <button type="submit" class="btn btn-default" data-dismiss="modal">Cancel</button>
          <button type="submit" class="btn btn-default pull-left" onclick="deleteAc()"><span class="glyphicon glyphicon-trash"></span> Delete</button>
        </div>
      </div>  
    </div>
  </div>
      
  <!-- MODAL DE DOOR-->
  <div class="modal fade" id="device-door" role="dialog">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
            <h3 class="modal-title text-center">Door</h3>
        </div>
        <div class="modal-body">
          <form class="form-horizontal">
            <div class="form-group">
              <label for="door-type" class="control-label col-sm-4" style="text-align: right">Type:</label>
              <div class="col-sm-8">
                <p class="form-control-static" id="door-type" style="text-align: left">Door</p>
              </div>
              <br>
              <label for="door-name" class="control-label col-sm-4" style="text-align: right;">Name:</label>
              <div class="col-sm-8">
                <p class="form-control-static" id="door-name" style="text-align: left"></p> <!--hay que agregar el nombre que eligio el usuario-->
              </div>
              <label for="door-change-name" class="control-label col-sm-4" style="text-align: right">Change name:</label>
              <div class="col-sm-8">
                <input type="text" class="form-control" id="door-change-name" placeholder="Enter new name" name="door-change-name">
                <p class="error" id="error-name-door">The name must have between 3 and 30 characters </p>
                <p class="error" id="error-nameExist-door">This name already exists</p>
              </div>
              <br>
              <label for="door-description" class="control-label col-sm-4" style="text-align: right">Description:</label>
              <div class="col-sm-8">
                <p class="form-control-static" id="door-description" style="text-align: left" id="door-description"> </p> <!--hay que agregar la descripcion que puso el usuario si es que la hubo, y "none" si es que no puso nada-->
              </div>
              <label for="door-change-description" class="control-label col-sm-4" style="text-align: right">Change description:</label>
              <div class="col-sm-8">
                <input type="text" class="form-control" placeholder="Enter new description" name="door-change-description" id="door-change-description">
              </div>
              <br>
              <label for="door-status" class="control-label col-sm-4" style="text-align: right">Status:</label>
              <div class="col-sm-8">
                <!--agregado por cata(comentado) -->
                <!--<fieldset id="door-status-check">  
                  <label class="radio-inline"><input type="radio" name="door-status-check" id="door-open">Open</label>
                  <label class="radio-inline"><input type="radio" name="door-status-check" id="door-closed" checked>Closed</label>
                </fieldset>--><!--agregado por cata (comentado)-->
                <input type="checkbox" data-toggle="toggle" data-on="Open" data-off="Closed" id="door-switch" data-width="82"><!--agregado por cata -->
              </div>
              <br>
              <label for="door-lock" class="control-label col-sm-4" style="text-align: right">Lock state:</label>
              <div class="col-sm-8">
                <!--agregado por cata (comentado)-->
                <!--<fieldset id="door-lock-check">  
                  <label class="radio-inline"><input type="radio" name="door-lock-check" id="door-locked">Locked</label>                esto hay que ponerlo en disabled si la puerta esta abierta
                  <label class="radio-inline"><input type="radio" name="door-lock-check" id="door-unlocked" checked>Unlocked</label>      
                </fieldset>--><!--agregado por cata (comentado)-->
                <input type="checkbox" data-toggle="toggle" data-on="Locked" data-off="Unlocked" id="lock-switch" data-width="100"><!--agregado por cata -->
              </div>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="submit" class="btn btn-primary" onclick="saveChangesDoor()">Accept </button>
          <button type="submit" class="btn btn-default" data-dismiss="modal">Cancel</button>
          <button type="submit" class="btn btn-default pull-left" onclick="deleteDoor()"><span class="glyphicon glyphicon-trash"></span> Delete</button>
        </div>
      </div>  
    </div>
  </div>

  <!-- Modal de refrigerator-->
  <div class="modal fade" id="device-refrigerator" role="dialog">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
            <h3 class="modal-title text-center">Refrigerator</h3>
        </div>
        <div class="modal-body">
          <form class="form-horizontal">
            <div class="form-group">
              <label for="refrigerator-type" class="control-label col-sm-6" style="text-align: right">Type:</label>
              <div class="col-sm-6">
                <p class="form-control-static" id="refrigerator-type" style="text-align: left">Refrigerator</p>
              </div>
              <br>
              <label for="refrigerator-name" class="control-label col-sm-6" style="text-align: right;">Name:</label>
              <div class="col-sm-6">
                <p class="form-control-static" id="refrigerator-name" style="text-align: left"></p> <!--hay que agregar el nombre que eligio el usuario-->
              </div>
              <label for="refrigerator-change-name" class="control-label col-sm-6" style="text-align: right">Change name:</label>
              <div class="col-sm-6">
                <input type="text" class="form-control" id="refrigerator-change-name" placeholder="Enter new name" name="refrigerator-change-name">
                <p class="error" id="error-name-refrigerator">The name must have between 3 and 30 characters </p>
                <p class="error" id="error-nameExist-refrigerator">This name already exists</p>
              </div>
              <br>
              <label for="refrigerator-description" class="control-label col-sm-6" style="text-align: right">Description:</label>
              <div class="col-sm-6">
                <p class="form-control-static" id="refrigerator-description" style="text-align: left"></p> <!--hay que agregar la descripcion que puso el usuario si es que la hubo, y "none" si es que no puso nada-->
              </div>
              <label for="refrigerator-change-description" class="control-label col-sm-6" style="text-align: right">Change description:</label>
              <div class="col-sm-6">
                <input type="text" class="form-control" id="refrigerator-change-description" placeholder="Enter new description" name="refrigerator-change-description">
              </div>
              <br>
              <p class="trampa">a</p>
              <label for="refrigerator-change-temperature" class="control-label col-sm-6" style="text-align: right;">Change temperature:</label>
              <div class="col-sm-6">
                <input type="number" class="form-control" id="refrigerator-change-temperature" placeholder="Enter new temperature (2 - 8)" name="refrigerator-change-temperature" min="2" max="8">
                <p class="error" id="error-refrigerator-temperature">The temperature must be between 2 and 8</p>
              </div>
              <br>
              <p class="trampa">a</p>
              <label for="refrigerator-change-freezertemperature" class="control-label col-sm-6" style="text-align: right;">Change freezer temperature:</label>
              <div class="col-sm-6">
                <input type="number" class="form-control" id="refrigerator-change-freezertemperature" placeholder="Enter new temperature ((-20) - (-8))" name="refrigerator-change-freezertemperature" min="-20" max="-8">
                <p class="error" id="error-refrigerator-freezertemperature">The freezer temperature must be between -20 and -8</p>
              </div>
              <br>
              <p class="trampa">a</p>
              <label for="refrigerator-change-mode" class="control-label col-sm-6" style="text-align: right;">Change mode:</label>
              <div class="col-sm-6">
                <select class="form-control" id="refrigerator-change-mode">
                    <option val="default">Default</option>
                    <option val="vacation">Vacation</option>
                    <option val="party">Party</option>
                  </select>
                  <p class="error" id="error-refrigerator-mode">You must select an option</p>
              </div>
            </div> 
          </form>
        </div>
        <div class="modal-footer">
          <button type="submit" class="btn btn-primary" onclick="saveChangesRefrigerator()">Accept </button>
          <button type="submit" class="btn btn-default" data-dismiss="modal">Cancel</button>
          <button type="submit" class="btn btn-default pull-left" onclick="deleteFridge()"><span class="glyphicon glyphicon-trash"></span> Delete</button>
        </div>
      </div>  
    </div>
  </div>    


<!-- Page content -->
<div class="my-content my-padding" id="devicesContainer" style="max-width:1564px">

  <!-- Project Section -->
  <div class="my-container my-padding-0-32" id="SwitchedOn">
    <h3 class="my-border-bottom my-padding-0-16">Switched On</h3>
  </div>

<!-- Aca estarian los dispositivos añadidos dinamicamente-->
  
<!-- End page content -->
</div>



<script>

var api = class {
  static get baseUrl() {
    return "http://127.0.0.1:8080/api/";
  }

  static get timeout() {
    return 60 * 1000;
  }
}

api.device = class {
  static get url() {
    return api.baseUrl + "devices/";
  }

  static add(device) {
   return $.ajax({
      url: api.device.url,
      method: "POST",
      dataType: "json",
      timeout: api.timeout,
      data: device
    }); 
  }

  static modify(device) {
   return $.ajax({
      url: api.device.url + device.id,
      method: "PUT",
      dataType: "json",
      timeout: api.timeout,
      data:device
    }); 
  }

  static delete(id) {
   return $.ajax({
      url: api.device.url + id,
      method: "DELETE",
      dataType: "json",
      timeout: api.timeout,
    }); 
  }

  static get(id) {
    return $.ajax({
      url: api.device.url + id,
      method: "GET",
      dataType: "json",
      timeout: api.timeout
    });
  }

  static linkToRoom(idDevice,idRoom){
      return $.ajax({
      url: "http://127.0.0.1:8080/api" + /devices/+ idDevice + /rooms/ + idRoom,
      method: "POST",
      dataType: "json",
      timeout: api.timeout
    });
  }

  static getAll(){
    return $.ajax({
      url: "http://127.0.0.1:8080/api/devices",
      method: "GET",
      dataType: "json",
      timeout: api.timeout
    });
  }

  static getTypes(){
    return $.ajax({
      url: "http://127.0.0.1:8080/api/devicetypes",
      method: "GET",
      dataType: "json",
      timeout: api.timeout
    });
  }

  static getState(deviceID){
    return $.ajax({
      url: "http://127.0.0.1:8080/api/devices/" + deviceID + "/getState",
      method: "PUT",
      dataType: "json",
      async: false,
      timeout: api.timeout,
    });
  }

}

api.model = api.model || {};

api.model.device = class {
  constructor(typeId, name, meta) {
    if (typeId) {
      this.typeId = typeId;
    } else {
      delete(this.typeId);
    }
    this.name = name;
    this.meta = meta;
  }
}

function addAttributesOfDeviceButton(deviceButton, deviceImage){

  switch(deviceButton.getAttribute("type")){

    case "eu0v2xgprrhhg41g" :
        deviceImage.setAttribute("src", "Blinds.png");
        deviceButton.setAttribute("data-type","blinds");
        buttonDevice.setAttribute("onclick","viewBlindState(this)");
        break;

    case "go46xmbqeomjrsjr":
        deviceImage.setAttribute("src", "Lamp.png");
        deviceButton.setAttribute("data-type","lamp");
        deviceButton.setAttribute("onclick","viewLampState(this)");
        break;

    case "im77xxyulpegfmv8":
        deviceImage.setAttribute("src", "Oven.png");
        deviceButton.setAttribute("data-type","oven");
        deviceButton.setAttribute("onclick","viewOvenState(this)");
        break;

    case "li6cbv5sdlatti0j":
        deviceImage.setAttribute("src", "Ac.png");
        deviceButton.setAttribute("data-type","ac");
        deviceButton.setAttribute("onclick","viewAcState(this)");
        break;

    case "lsf78ly0eqrjbz91":
        deviceImage.setAttribute("src", "Door.png");
        deviceButton.setAttribute("data-type","door");
        deviceButton.setAttribute("onclick","viewDoorState(this)");
        break;

    case "rnizejqr2di0okho":
        deviceImage.setAttribute("src", "Fridge.png");
        deviceButton.setAttribute("data-type","refrigerator");
        deviceButton.setAttribute("onclick","viewRefrigeratorState(this)");
        break;

    default:
        deviceButton.disabled = true;
        deviceImage.setAttribute("src", "Default.png");
  }
}


function loadDevice(data, i){

  var deviceContainer = document.createElement("div");
  deviceContainer.classList.add("my-col");
  deviceContainer.classList.add("l3");
  deviceContainer.classList.add("m6");
  deviceContainer.classList.add("my-margin-bottom");

  var displayContainer = document.createElement("div");
  displayContainer.classList.add("my-display-container");

  deviceContainer.appendChild(displayContainer);

  var tag = document.createElement("div");
  tag.classList.add("my-display-topleft");
  tag.classList.add("my-black");
  tag.classList.add("my-padding");

  displayContainer.appendChild(tag);

  var deviceName = data.devices[i].name;
  tag.innerHTML = deviceName;

  var deviceButton = document.createElement("button");
  deviceButton.classList.add("btn");
  deviceButton.classList.add("btn-default");
  deviceButton.setAttribute("type", data.devices[i].typeId);
  deviceButton.setAttribute("id", data.devices[i].id);
  
  deviceButton.setAttribute("data-name",data.devices[i].name)
  deviceButton.setAttribute("data-desc",data.devices[i].meta)
  deviceButton.setAttribute("data-typeID",data.devices[i].typeId)
  deviceButton.setAttribute("data-ID",data.devices[i].id)

  displayContainer.appendChild(deviceButton);

  var deviceImage = document.createElement("img");
  deviceImage.setAttribute("alt", deviceName);
  deviceImage.classList.add("my-image");

  deviceButton.appendChild(deviceImage);

  addAttributesOfDeviceButton(deviceButton, deviceImage);

  return deviceContainer;
}


function createRow(){
  var row = document.createElement("div");
  row.classList.add("my-row-padding");

  return row;
}

function loadDevicesHTML(data){
  var i, j, father, currentRow;

  father = document.getElementById("devicesContainer");

  for(i = 0, j = 0; i < data.devices.length; i++){
 //   if(){
      if((i % 4) == 0){
        currentRow = createRow();
        father.appendChild(currentRow);
      }

      currentRow.appendChild(loadDevice(data, i));
 //     j++;
 //   }
  }
}

function loadDevices(){

  api.device.getAll()

  .done(function (data) {
    loadDevicesHTML(data);
  })

  .fail(function (jqXHR, textStatus) {
    alert ('Request failed:' + textStatus);
  })
}

function viewBlindState(button){
   cleanAllErrors()
   document.getElementById("device-blinds").setAttribute("data-device",button.getAttribute("id"))
   updateDeviceBlindModal(button)
   $("#device-blinds").modal();
}

function updateDeviceBlindModal(button){
  document.getElementById("blinds-name").innerHTML = button.getAttribute("data-name");
  document.getElementById("blinds-description").innerHTML = button.getAttribute("data-desc");
  api.device.getState(button.getAttribute("data-ID"))
  .done(function (data) {
      updateBlindState(button,data)
  })
  .fail(function (jqXHR, textStatus) {
      alert ('Request failed: al cargar el status de cortina' + textStatus);
  })
}

function saveChangesBlinds(){
    cleanAllErrors()
    var blind = new api.blind(null,null,null,null)
    if(modifyDevice("device-blinds","blinds-change-name","blinds-change-description",blind,"blind") == false){
      return;
    }
    updateDevice(blind)
    if(document.getElementById("blinds-switch").checked == true){
      blind.up(blind.id)
    }
    else{
      blind.down(blind.id)
    }
    $("#device-blinds").modal("hide");
}

function deleteBlinds(){
  var device = document.getElementById(document.getElementById("device-blinds").getAttribute("data-device"));

  $("#device-blinds").modal("hide");
  $("#confirmation-Delete-device").modal();

  document.getElementById("delete-modal-device-name").innerHTML = "Delete " + device.getAttribute("data-name") + "?";

  document.getElementById("accept-delete-device").onclick = function() {deleteDevice(device)};
}

function deleteLamp(){
  var device = document.getElementById(document.getElementById("device-lamp").getAttribute("data-device"));

  $("#device-lamp").modal("hide");
  $("#confirmation-Delete-device").modal();

  document.getElementById("delete-modal-device-name").innerHTML = "Delete " + device.getAttribute("data-name") + "?";

  document.getElementById("accept-delete-device").onclick = function() {deleteDevice(device)};
}

function deleteDoor(){
  var device = document.getElementById(document.getElementById("device-door").getAttribute("data-device"));

  $("#device-door").modal("hide");
  $("#confirmation-Delete-device").modal();

  document.getElementById("delete-modal-device-name").innerHTML = "Delete " + device.getAttribute("data-name") + "?";

  document.getElementById("accept-delete-device").onclick = function() {deleteDevice(device)};
}

function deleteAc(){
  var device = document.getElementById(document.getElementById("device-ac").getAttribute("data-device"));

  $("#device-ac").modal("hide");
  $("#confirmation-Delete-device").modal();

  document.getElementById("delete-modal-device-name").innerHTML = "Delete " + device.getAttribute("data-name") + "?";

  document.getElementById("accept-delete-device").onclick = function() {deleteDevice(device)};
}

function deleteOven(){
  var device = document.getElementById(document.getElementById("device-oven").getAttribute("data-device"));

  $("#device-oven").modal("hide");
  $("#confirmation-Delete-device").modal();

  document.getElementById("delete-modal-device-name").innerHTML = "Delete " + device.getAttribute("data-name") + "?";

  document.getElementById("accept-delete-device").onclick = function() {deleteDevice(device)};
}

function deleteFridge(){
  var device = document.getElementById(document.getElementById("device-refrigerator").getAttribute("data-device"));

  $("#device-refrigerator").modal("hide");
  $("#confirmation-Delete-device").modal();

  document.getElementById("delete-modal-device-name").innerHTML = "Delete " + device.getAttribute("data-name") + "?";

  document.getElementById("accept-delete-device").onclick = function() {deleteDevice(device)};
}

function deleteDevice(device){
  api.device.delete(device.getAttribute("data-ID"))

  .done(function(data){
    var father = device.parentElement;
    father.parentElement.removeChild(father);
    $("#confirmation-Delete-device").modal("hide");
  })

  .fail(function(jqXHR, textStatus){
    alert('Request failed: al borrar el device' + textStatus);
  })  
}

function modifyDevice(modalID,newNameID,newDescID,deviceObj,deviceType){
   var device = document.getElementById(document.getElementById(modalID).getAttribute("data-device"));
   deviceObj.id = device.getAttribute("data-ID")
   deviceObj.name = document.getElementById(newNameID).value;
   deviceObj.description = document.getElementById(newDescID).value;
   deviceObj.typeId = device.getAttribute("data-typeID")
   var errorName = document.getElementById("error-name-" + deviceType)
   var errorExistName = document.getElementById("error-nameExist-" + deviceType)
   if( (deviceObj.name.length != 0 && deviceObj.name.length < 3) || deviceObj.name.length > 30){
    errorName.style.display = "block";
    document.getElementById(newNameID).value = ""
    return false;
   }
   if(deviceNameExist(deviceObj.name,errorExistName)){
    document.getElementById(newNameID).value = ""
    return false;
   }
   if(deviceObj.name.length != 0 || deviceObj.description.length != 0){
     if(deviceObj.description == "")
      deviceObj.description = device.getAttribute("data-desc");
     if(deviceObj.name  == "")
      deviceObj.name = device.getAttribute("data-name")
    }else{
      deviceObj.description = device.getAttribute("data-desc");
      deviceObj.name = device.getAttribute("data-name")
    }

  device.setAttribute("data-name",deviceObj.name)
  device.setAttribute("data-desc",deviceObj.description)
  document.getElementById(newDescID).value = "";
  document.getElementById(newNameID).value = "";
  return true;
}

function updateDevice(deviceObj){
    api.device.get(deviceObj.id)
    .done(function (data) {
        data.device.name = deviceObj.name
        data.device.meta = deviceObj.description
        api.device.modify(data.device)
        .done(function (boolean){
          addDeviceToRoom(actualRoomName,data.device.id,data.device,0)
        })
        .fail(function (jqXHR, textStatus) {
        alert ('Request failed:' + textStatus);
        })
      })
    .fail(function (jqXHR, textStatus) {
      alert ('Request failed:' + textStatus);
      })
}

function updateBlindState(button,data){
  var status = data.result.status
  if(status == "opened" || status == "opening"){
    document.getElementById("blinds-switch").checked = true;
  }
  else{
    document.getElementById("blinds-switch").checked = false;
  }
}

function viewLampState(button){
   cleanAllErrors()
   document.getElementById("device-lamp").setAttribute("data-device",button.getAttribute("id"))
   updateDeviceLampModal(button)
   $("#device-lamp").modal();
}

function DisableLampOptions(button){
  if( button.checked == true){
    document.getElementById("lamp-change-brightness").disabled = false
    document.getElementById("lamp-change-color").disabled = false
  }else{
    document.getElementById("lamp-change-brightness").disabled = true
    document.getElementById("lamp-change-color").disabled = true
  }
}

function updateDeviceLampModal(button){
  document.getElementById("lamp-name").innerHTML = button.getAttribute("data-name");
  document.getElementById("lamp-description").innerHTML = button.getAttribute("data-desc");
  api.device.getState(button.getAttribute("data-ID"))
  .done(function (data) {
      updateLampState(button,data)
  })
  .fail(function (jqXHR, textStatus) {
      alert ('Request failed: al cargar el status de cortina' + textStatus);
  })
}

function updateLampState(button,data){
  var status = data.result.status
  DisableLampOptions(document.getElementById("lamp-switch"))
  if(status == "on"){
    document.getElementById("lamp-switch").checked = true;
    document.getElementById("lamp-change-brightness").disabled = false
    document.getElementById("lamp-change-color").disabled = false
  }
  else{
    document.getElementById("lamp-switch").checked = false
    document.getElementById("lamp-change-brightness").disabled = true
    document.getElementById("lamp-change-color").disabled = true
  }
  document.getElementById("lamp-change-brightness").value = data.result.brightness;
  document.getElementById("lamp-change-color").value = data.result.color;
  button.setAttribute("data-brightness", data.result.brightness);
  button.setAttribute("data-color", data.result.color);
}



function saveChangesLamp(){
    cleanAllErrors()
    var fieldError = false;
    var lamp = new api.lamp(null,null,null,null)
    if(modifyDevice("device-lamp","lamp-change-name","lamp-change-description",lamp,"lamp") == false){
      fieldError = true;
    }
    var newBrightness = document.getElementById("lamp-change-brightness").value;
    if(newBrightness > 100 || newBrightness < 0){
      document.getElementById("error-lamp-brightness").style.display = "block"
      document.getElementById("lamp-change-brightness").value = document.getElementById(lamp.id).getAttribute("data-brightness")
      fieldError = true;
    }
    var newColor = document.getElementById("lamp-change-color").value;
    newColor = newColor.substring(1);
    if(! isColor(newColor)){
      document.getElementById("lamp-change-brightness").value = document.getElementById(lamp.id).getAttribute("data-color")
      document.getElementById("error-lamp-color").style.display = "block"
      fieldError = true;
    }
    if(fieldError){
      return;
    }
    updateDevice(lamp)
    var newBrightnessJSON={"0":newBrightness}; //si fueran 2 parametros seria {"0":newBrightness,"1":segundaParam}
    var newColorJSON={"0":newColor}
    var parameterBrightness = JSON.stringify(newBrightnessJSON)
    var parameterColor = JSON.stringify(newColorJSON)
    if(document.getElementById("lamp-switch").checked == true){
      lamp.turnOn(lamp.id)
      .done(function (data) {
        lamp.changeBrightness(lamp.id,parameterBrightness)
        lamp.changeColor(lamp.id,parameterColor)
        })
      .fail(function (jqXHR, textStatus) {
        alert ('Request failed:' + textStatus);
        })
    }
    else{
      lamp.turnOff(lamp.id)
    }

    $("#device-lamp").modal("hide");
}

  function viewOvenState(button){
    cleanAllErrors()
    document.getElementById("device-oven").setAttribute("data-device",button.getAttribute("id"))
    updateDeviceOvenModal(button)
    $("#device-oven").modal();
  }

  function updateDeviceOvenModal(button){
    document.getElementById("oven-name").innerHTML = button.getAttribute("data-name");
    document.getElementById("oven-description").innerHTML = button.getAttribute("data-desc");
    api.device.getState(button.getAttribute("id"))
    .done(function(data) {
        updateOvenState(button,data)
    })
    .fail(function (jqXHR, textStatus) {
        alert ('Request failed: al cargar el status de cortina' + textStatus);
    })
}

  function updateOvenState(button,data){
    var status = data.result.status
    if(status == "on"){
      document.getElementById("oven-switch").checked = true;
    }
    else{
      document.getElementById("oven-switch").checked = false;
    }
    document.getElementById("oven-change-temperature").value = data.result.temperature;
    document.getElementById("oven-change-heatmode").value = data.result.heat;
    document.getElementById("oven-change-grillmode").value = data.result.grill;
    document.getElementById("oven-change-convectionmode").value = data.result.convection;
    button.setAttribute("data-temperature", data.result.temperature);
    button.setAttribute("data-heatmode", data.result.heat);
    button.setAttribute("data-grillmode", data.result.grill);
    button.setAttribute("data-convectionmode", data.result.convection);

}

function saveChangesOven(){
    cleanAllErrors()
    var fieldError = false;
    var oven = new api.oven(null,null,null,null)
    if(modifyDevice("device-oven","oven-change-name","oven-change-description",oven,"oven") == false){
      fieldError = true
    }

    var newTemperature = document.getElementById("oven-change-temperature").value;
    if(newTemperature < 90 || newTemperature > 230){
      document.getElementById("error-oven-temperature").style.display = "block"
      document.getElementById("oven-change-temperature").value = document.getElementById(oven.id).getAttribute("data-temperature")
      fieldError = true
    }
    var newTemperatureJSON={"0":newTemperature}
    var parameterTemperature = JSON.stringify(newTemperatureJSON)
    var newHeatMode = document.getElementById("oven-change-heatmode").value;
    var newHeatModeJSON={"0":newHeatMode}
    var parameterHeatMode = JSON.stringify(newHeatModeJSON)
    var newGrillMode = document.getElementById("oven-change-grillmode").value;
    var newGrillModeJSON={"0":newGrillMode}
    var parameterGrillMode = JSON.stringify(newGrillModeJSON)
    var newConvectionMode = document.getElementById("oven-change-convectionmode").value;
    
    if(newHeatMode == ""){
      document.getElementById("error-oven-heatmode").style.display = "block"
      document.getElementById("oven-change-heatmode").value = document.getElementById(oven.id).getAttribute("data-heatmode")
      fieldError = true;
    }
    if(newGrillMode == ""){
      document.getElementById("error-oven-grillmode").style.display = "block"
      document.getElementById("oven-change-grillmode").value = document.getElementById(oven.id).getAttribute("data-grillmode")
      fieldError = true;
    }
    if(newConvectionMode == ""){
      document.getElementById("error-oven-convectionmode").style.display = "block"
      document.getElementById("oven-change-convectionmode").value = document.getElementById(oven.id).getAttribute("data-convectionmode")
      fieldError = true;
    }
    if(fieldError)
      return;
    updateDevice(oven)
    var newConvectionModeJSON={"0":newConvectionMode}
    var parameterConvectionMode = JSON.stringify(newConvectionModeJSON)

    if(document.getElementById("oven-switch").checked == true){
      oven.turnOn(oven.id)
      .done(function (data) {
        if(newTemperature != "")
          oven.setTemperature(oven.id,parameterTemperature)
        if(newHeatMode != "")
          oven.setHeat(oven.id,parameterHeatMode)
        if(newGrillMode != "")
          oven.setGrill(oven.id,parameterGrillMode)
        if(newConvectionMode != "")
          oven.setConvection(oven.id,parameterConvectionMode)
        })
      .fail(function (jqXHR, textStatus) {
        alert ('Request failed:' + textStatus);
        })
    }
    else{
      oven.turnOff(oven.id)
    }
    $("#device-oven").modal("hide");
}

  function viewAcState(button){
    cleanAllErrors()
    document.getElementById("device-ac").setAttribute("data-device",button.getAttribute("id"))
    updateDeviceAcModal(button)
    $("#device-ac").modal();
  }

  function updateDeviceAcModal(button){
    document.getElementById("ac-name").innerHTML = button.getAttribute("data-name");
    alert("asd")
    document.getElementById("ac-description").innerHTML = button.getAttribute("data-desc");

    api.device.getState(button.getAttribute("data-ID"))
    .done(function (data) {
        updateAcState(button,data)
    })
    .fail(function (jqXHR, textStatus) {
        alert ('Request failed: al cargar el status de cortina' + textStatus);
    })
}

  function updateAcState(button,data){
    var status = data.result.status
    if(status == "on"){
    document.getElementById("ac-switch").checked = true;
    }else{
    document.getElementById("ac-switch").checked = false;
    }
    document.getElementById("ac-change-temperature").value = data.result.temperature;
    document.getElementById("ac-change-mode").value = data.result.mode;
    document.getElementById("ac-change-verticalswing").value = data.result.verticalSwing;
    document.getElementById("ac-change-horizontalswing").value = data.result.horizontalSwing;
    document.getElementById("ac-change-fanspeed").value = data.result.fanSpeed;
    button.setAttribute("data-temperature", data.result.temperature);
    button.setAttribute("data-verticalswing", data.result.verticalSwing);
    button.setAttribute("data-horizontalswing", data.result.horizontalSwing);
    button.setAttribute("data-mode", data.result.mode);
    button.setAttribute("data-fanspeed", data.result.fanSpeed);
}

function saveChangesAc(){
    cleanAllErrors()
    var fieldError = false;
    var ac = new api.ac(null,null,null,null)
    if(modifyDevice("device-ac","ac-change-name","ac-change-description",ac,"ac") == false){
      fieldError = true;
    }
    var newTemperature = document.getElementById("ac-change-temperature").value;
    var newTemperatureJSON={"0":newTemperature}
    var parameterTemperature = JSON.stringify(newTemperatureJSON)
    if(newTemperature < 18 || newTemperature > 38){
      fieldError = true;
      document.getElementById("error-ac-temperature").style.display = "block"
      document.getElementById("ac-change-temperature").value = document.getElementById(ac.id).getAttribute("data-temperature");
    }
    var newMode = document.getElementById("ac-change-mode").value;
    var newModeJSON={"0":newMode}
    var parameterMode = JSON.stringify(newModeJSON)
    var newVerticalswing = document.getElementById("ac-change-verticalswing").value;
    var newVerticalswingJSON={"0":newVerticalswing}
    var parameterVerticalswing = JSON.stringify(newVerticalswingJSON)
    var newHorizontalswing = document.getElementById("ac-change-horizontalswing").value;
    var newHorizontalswingJSON={"0":newHorizontalswing}
    var parameterHorizontalswing = JSON.stringify(newHorizontalswingJSON)
    var newFanspeed = document.getElementById("ac-change-fanspeed").value;
    var newFanspeedJSON={"0":newFanspeed}
    var parameterFanspeed = JSON.stringify(newFanspeedJSON)

    if(newMode == ""){
      fieldError = true;
      document.getElementById("error-ac-mode").style.display = "block"
      document.getElementById("ac-change-mode").value = document.getElementById(ac.id).getAttribute("data-mode");
    }

    if(newVerticalswing == ""){
      fieldError = true;
      document.getElementById("error-ac-verticalswing").style.display = "block"
      document.getElementById("ac-change-verticalswing").value = document.getElementById(ac.id).getAttribute("data-verticalswing");
    }

    if(newHorizontalswing == ""){
      fieldError = true;
      document.getElementById("error-ac-horizontalswing").style.display = "block"
      document.getElementById("ac-change-horizontalswing").value = document.getElementById(ac.id).getAttribute("data-horizontalswing");
    }

    if(newFanspeed == ""){
      fieldError = true;
      document.getElementById("error-ac-fanspeed").style.display = "block"
      document.getElementById("ac-change-fanspeed").value = document.getElementById(ac.id).getAttribute("data-fanspeed");
    }

    if(fieldError)
      return;
    updateDevice(ac)
    if(document.getElementById("ac-switch").checked == true){
      ac.turnOn(ac.id)
      .done(function (data) {
        if(newTemperature != "")
          ac.setTemperature(ac.id,parameterTemperature)
        if(newMode != "")
          ac.setMode(ac.id,parameterMode)
        if(newVerticalswing != "")
          ac.setVerticalSwing(ac.id,parameterVerticalswing)
        if(newHorizontalswing != "")
          ac.setHorizontalSwing(ac.id,parameterHorizontalswing)
        if(newFanspeed != "")
          ac.setFanSpeed(ac.id,parameterFanspeed)
        })
      .fail(function (jqXHR, textStatus) {
        alert ('Request failed:' + textStatus);
        })
    }
    else{
      ac.turnOff(ac.id)
    }
    $("#device-ac").modal("hide");
}


  function viewDoorState(button){
    cleanAllErrors()
    document.getElementById("device-door").setAttribute("data-device",button.getAttribute("id"))
    updateDeviceDoorModal(button)
    $("#device-door").modal();
  }

  function updateDeviceDoorModal(button){
    document.getElementById("door-name").innerHTML = button.getAttribute("data-name");
    document.getElementById("door-description").innerHTML = button.getAttribute("data-desc");
    api.device.getState(button.getAttribute("data-ID"))
    .done(function (data) {
        updateDoorState(button,data)
    })
    .fail(function (jqXHR, textStatus) {
        alert ('Request failed: al cargar el status de cortina' + textStatus);
    })
}

  function updateDoorState(button,data){
    var status = data.result.status
    var lock = data.result.lock
    if(status == "opened"){
      document.getElementById("door-switch").checked = true;
    }else{
      document.getElementById("door-switch").checked = false;
    }
    if(lock == "unlocked"){
      document.getElementById("lock-switch").checked = false;
    }else{
      document.getElementById("lock-switch").checked = true;
    }
}

function saveChangesDoor(){
    cleanAllErrors()
    var door = new api.door(null,null,null,null)
    if(modifyDevice("device-door","door-change-name","door-change-description",door,"door") == false)
      return;

    updateDevice(door)
    if(document.getElementById("door-switch").checked == true){
      door.open(door.id)
    }
    else{
      door.close(door.id)
      .done(function (data) {
        if(document.getElementById("lock-switch").checked == true){
          door.lock(door.id)
        }else{
          door.unlock(door.id)
        }
        })
      .fail(function (jqXHR, textStatus) {
        alert ('Request failed:' + textStatus);
        })
    }
    $("#device-door").modal("hide");
}


function viewRefrigeratorState(button){
    cleanAllErrors()
    document.getElementById("device-refrigerator").setAttribute("data-device",button.getAttribute("id"))
    updateDeviceRefrigeratorModal(button)
    $("#device-refrigerator").modal();
  }

function updateDeviceRefrigeratorModal(button){
    document.getElementById("refrigerator-name").innerHTML = button.getAttribute("data-name");
    document.getElementById("refrigerator-description").innerHTML = button.getAttribute("data-desc");
    api.device.getState(button.getAttribute("data-ID"))
    .done(function (data) {
        updateRefrigeratorState(button,data)
    })
    .fail(function (jqXHR, textStatus) {
        alert ('Request failed: al cargar el status de cortina' + textStatus);
    })
}

function updateRefrigeratorState(button,data){
    document.getElementById("refrigerator-change-freezertemperature").value = data.result.freezerTemperature;
    document.getElementById("refrigerator-change-temperature").value = data.result.temperature;
    document.getElementById("refrigerator-change-mode").value = data.result.mode;
    button.setAttribute("data-temperature",data.result.temperature)
    button.setAttribute("data-freezertemperature",data.result.freezerTemperature)
    button.setAttribute("data-mode",data.result.mode)
}

function saveChangesRefrigerator(){
    cleanAllErrors()
    var fieldError = false;
    var refrigerator = new api.refrigerator(null,null,null,null)
    if(modifyDevice("device-refrigerator","refrigerator-change-name","refrigerator-change-description",refrigerator,"refrigerator") == false){
      fieldError = true;
    }
    var newTemperature = document.getElementById("refrigerator-change-temperature").value;
    var newTemperatureJSON={"0":newTemperature}
    var parameterTemperature = JSON.stringify(newTemperatureJSON)
    if(newTemperature < 2 || newTemperature > 8){
      fieldError = true;
      document.getElementById("error-refrigerator-temperature").style.display = "block"
      document.getElementById("refrigerator-change-temperature").value = document.getElementById(refrigerator.id).getAttribute("data-temperature");
    }
    var newFreezerTemperature = document.getElementById("refrigerator-change-freezertemperature").value;
    var newFreezerTemperatureJSON={"0":newFreezerTemperature}
    var parameterFreezerTemperature = JSON.stringify(newFreezerTemperatureJSON)
    if(newFreezerTemperature > -2 || newFreezerTemperature < -20){
      fieldError = true;
      document.getElementById("error-refrigerator-freezertemperature").style.display = "block"
      document.getElementById("refrigerator-change-freezertemperature").value = document.getElementById(refrigerator.id).getAttribute("data-freezertemperature");
    }
    var newMode = document.getElementById("refrigerator-change-mode").value;
    var newModeJSON={"0":newMode}
    var parameterMode = JSON.stringify(newModeJSON)
    if(newMode == ""){
      fieldError = true;
      document.getElementById("error-refrigerator-mode").style.display = "block"
      document.getElementById("refrigerator-change-mode").value = document.getElementById(refrigerator.id).getAttribute("data-mode");
    }
    if(fieldError){
      return;
    }
    updateDevice(refrigerator)
    refrigerator.setFreezerTemperature(refrigerator.id,parameterFreezerTemperature)
    refrigerator.setTemperature(refrigerator.id,parameterTemperature)
    refrigerator.setMode(refrigerator.id,parameterMode)
    $("#device-refrigerator").modal("hide");
}

function cleanAllErrors(){
    document.getElementById("error-name-blind").style.display = "none"
    document.getElementById("error-name-lamp").style.display = "none"
    document.getElementById("error-name-oven").style.display = "none"
    document.getElementById("error-name-ac").style.display = "none"
    document.getElementById("error-name-door").style.display = "none"
    document.getElementById("error-name-refrigerator").style.display = "none"
    document.getElementById("error-nameExist-blind").style.display = "none"
    document.getElementById("error-nameExist-lamp").style.display = "none"
    document.getElementById("error-nameExist-oven").style.display = "none"
    document.getElementById("error-nameExist-ac").style.display = "none"
    document.getElementById("error-nameExist-door").style.display = "none"
    document.getElementById("error-nameExist-refrigerator").style.display = "none"
    document.getElementById("error-lamp-color").style.display = "none"
    document.getElementById("error-lamp-brightness").style.display = "none"
    document.getElementById("error-oven-temperature").style.display = "none"
    document.getElementById("error-oven-heatmode").style.display = "none"
    document.getElementById("error-oven-grillmode").style.display = "none"
    document.getElementById("error-oven-convectionmode").style.display = "none"
    document.getElementById("error-ac-temperature").style.display = "none"
    document.getElementById("error-ac-mode").style.display = "none"
    document.getElementById("error-ac-verticalswing").style.display = "none"
    document.getElementById("error-ac-horizontalswing").style.display = "none"
    document.getElementById("error-ac-fanspeed").style.display = "none"
    document.getElementById("error-refrigerator-temperature").style.display = "none"
    document.getElementById("error-refrigerator-freezertemperature").style.display = "none"
    document.getElementById("error-refrigerator-mode").style.display = "none"
}


$(function() {
    $('#cp3').colorpicker({
       color: '#AA3399',
        format: 'hex',
    });
});


function isColor(color){
  for (var i = 0; i < color.length; i++) {
    var c = color.charAt(i);
    if( (c < '0' || c > '9') && ( c < 'a' || c > 'z') && ( c < 'A' || c > 'Z'))
      return false;
  }
  return true;
}

function isAlphaNumeric(str) {
  var code, i, len;
  for (i = 0, len = str.length; i < len; i++) {
    code = str.charCodeAt(i);
    if (!(code > 47 && code < 58) && // numeric (0-9)
        !(code > 64 && code < 91) && // upper alpha (A-Z)
        !(code > 96 && code < 123) && // lower alpha (a-z)
        !(code == '-')) {         // '-'
      return false;
    }
  }
  return true;
};

</script>

</body>
</html>
